<div class="header" style="margin-top:0 px;font-size:60%;">DAR: მეხუთე შეხვედრა</div>

რაოდენობრივ მონაცემთა ანალიზი R-გარემოში
========================================================
author: დავით სიჭინავა
date: 20 აპრილი, 2018
autosize: true
transition: none
css: css/style.css
font-family: 'BPG_upper'
<span style="font-weight:bold; font-family:BPG_upper;">მეხუთე შეხვედრა</span>




დღევანდელი შეხვედრის გეგმა
========================================================

* განუსაზღვრელობა
	+ შეფასება
	+ ჰიპოთეზის შემოწმება
* ერთი და ორი შერჩევის t-კრიტერიუმის ტესტი
* სტატისტიკური სიმძლავრე

შეფასება
========================================================
* პარამეტრი და შეფასება
* შემთხვევითი შერჩევა: ვცდილობთ, _შევაფასოთ პოპულაციის_ მნიშვნელობა

შეფასება: იდეალური შემთხვევა
========================================================
* შეფასების შეცდომა = $\overline{X}_{n} - p$
* პოპულაციის ჭეშმარიტი მნიშვნელობა არასდროსაა ცნობილი, შესაბამისად, აუცილებელია, გამოვთვალოთ შეცდომის _საშუალო მაგნიტუდა_

შეფასება: იდეალური შემთხვევა
========================================================
* გავიხსენოთ სიხშირული სტატისტიკის მთავარი პრინციპი და დავუშვათ, რომ რამდენჯერმე ვატარებთ ერთსა და იმავე ექსპერიმენტს  (გამოკითხვას, დაკვირვებას, ა.შ.). თუ ეს ექსპერიმენტები ერთმანეთზე არაა დამოკიდებული, შეფასების შეცდომაც ერთმანეთისგან დამოუკიდებელი იქნება
* აღნიშნული პირობა მნიშველოვანია, რადგან მოცემულ პირობებში, შეფასების შეცდომა არის _შემთხვევითი ცვლადი_

$\mathbb{E}(\overline{X}_{n}) = \frac{1}{n}\sum \mathbb{E}(X_{i}) = \mathbb{E}(X)$


შეფასება: შერჩევის და პოპულაციის საშუალო ექსპერიმენტული ეფექტი
========================================================
* დაუმახინჯებელი და თანმიმდევრული შეფასება
	+ შეფასების მათემატიკური მოლოდინი ემთხვევა პარამეტრს;
	+ შეფასება უახლოვდება პარამეტრს შერჩევის ზომის ზრდასთან ერთად;
	
* რანდომიზებულ კონტროლირებად ექსპერიმენტებში, ექსპერიმენტულ და საკონტროლო ჯგუფებს შორის სხვაობა არის ექსპერიმენტის შერჩევის საშუალო ეფექტის (SATE) დაუმახინჯებელი შეფასება.
* შეფასება ასევე დაუმახინჯებელი და თანმიმდევრულია პოპულაციის საშუალო ექსპერიმენტული ეფექტისთვის (PATE).

შეფასების სტანდარტული შეცდომა
========================================================
* თუ დაუმახინჯებელი შეფასება დიდ შუალედში მერყეობს, მას ნაკლები პრაქტიკული გამოყენება გააჩნია;
* ამ შემთხვევაში, შეფასების _სტანდარტულ გადახრას_ უნდა მივაქციოთ ყურადღება
* $s^2 = \sqrt{\sum_{i=1}^n (y_i - \bar{y})^2}$

სანდოობის ინტერვალები
========================================================

* შეფასების თავისებურების შესწავლისთვის, ჩვენ მხოლოდ საშუალოს და სტანდარტულ გადახრას კი არ უნდა შევხედოთ, არამედ - უნდა შევაფასოთ მთელი _შერჩევითი განაწილება_ 
* ამ მიზნით, უნდა გამოვიყენოთ ე.წ. _თეორიული განაწილება_. პრაქტიკაში, ამ მიზნით შესაძლებელია _ცენტრალური ზღვარითი თეორემა_ და დავუშვათ, რომ შერჩევის საშუალოს განაწილება მეტნაკლებად უახლოვდება ნორმალურს
* დამოუკიდებელი და ერთნაირად განაწილებული გარკვეული ტიპის შემთხვევითი სიდიდეების საშუალო არითმეტიკული მიისწრაფის სტანდარტული ნორმალური განაწილებისკენ, როდესაც ამ შემთხვევითი სიდიდეების რაოდენობა უსასრულოდ იზრდება
* თუ ზემოთხსენებული პირობები კმაყოფილდება, შეგვიძლია, გამოვიყენოთ შეფასების _სანდოობის ინტერვალი_

სანდოობის ინტერვალები
========================================================
* სანდოობის ინტერვალი არის შუალედი, რომელშიც წინასწარ შეთანხმებული ალბათობით, არსებობს ჩვენთვის საინტერესო _პარამეტრი_:
* $CI(\alpha) = [\overline{X}_{n}-z_{\alpha/2}*se; \overline{X}_{n}+z_{\alpha/2}*se; ]$
* როგორც ხედავთ, $z$-ქულები დამოკიდებულია _განაწილების ტიპზე_


სანდოობის ინტერვალები
========================================================

```r
n <- 1000 # შერჩევა
x.bar <- 0.6 #  წერტილოვანი შეფასება
s.e. <- sqrt(x.bar * (1 - x.bar) / n) # სტანდარტული შეცდომა
## 99% CI
c(x.bar - qnorm(0.995) * s.e., x.bar + qnorm(0.995) * s.e.)

## 95% CI
c(x.bar - qnorm(0.975) * s.e., x.bar + qnorm(0.975) * s.e.)
## 90% CI
c(x.bar - qnorm(0.95) * s.e., x.bar + qnorm(0.95) * s.e.)
```

ექსპერიმენტის ანალიზი
========================================================

```r
STAR <- read.csv("STAR.csv", head = TRUE)
hist(STAR$g4reading[STAR$classtype == 1], freq = FALSE, xlim = c(500, 900),
ylim = c(0, 0.01), main = "Small class",
xlab = "Fourth-grade reading test score")
abline(v = mean(STAR$g4reading[STAR$classtype == 1], na.rm = TRUE),
col = "blue")
hist(STAR$g4reading[STAR$classtype == 2], freq = FALSE, xlim = c(500, 900),
ylim = c(0, 0.01), main = "Regular class",
xlab = "Fourth-grade reading test score")
abline(v = mean(STAR$g4reading[STAR$classtype == 2], na.rm = TRUE),
col = "blue")
```

ექსპერიმენტის ანალიზი
========================================================

```r
n.small <-
sum(STAR$classtype == 1 & !is.na(STAR$g4reading))
est.small <- mean(STAR$g4reading[STAR$classtype == 1], na.rm = TRUE)
se.small <- sd(STAR$g4reading[STAR$classtype == 1], na.rm = TRUE) /
sqrt(n.small)
est.small
se.small

n.regular <- sum(STAR$classtype == 2 & !is.na(STAR$classtype) &
!is.na(STAR$g4reading))
```

ექსპერიმენტის ანალიზი
========================================================

```r
est.regular <- mean(STAR$g4reading[STAR$classtype == 2], na.rm = TRUE)
se.regular <- sd(STAR$g4reading[STAR$classtype == 2], na.rm = TRUE) /
sqrt(n.regular)
est.regular
```

ექსპერიმენტის ანალიზი
========================================================

```r
alpha <- 0.05

ci.small <- c(est.small - qnorm(1 - alpha / 2) * se.small,
est.small + qnorm(1 - alpha / 2) * se.small)
ci.small

ci.regular <- c(est.regular - qnorm(1 - alpha / 2) * se.regular,
est.regular + qnorm(1 - alpha / 2) * se.regular)
ci.regular
```

ექსპერიმენტის ანალიზი
========================================================

```r
# შერჩევის საშუალო ექსპერიმენტული ეფექტი
ate.est <- est.small - est.regular
ate.se <- sqrt(se.small^2 + se.regular^2)
ate.ci <- c(ate.est - qnorm(1 - alpha / 2) * ate.se,
ate.est + qnorm(1 - alpha / 2) * ate.se)
ate.ci
```

ექსპერიმენტის ანალიზი: სტიუდენტის ტ-კრიტერიუმი
========================================================

```r
c(est.small - qt(0.975, df = n.small - 1) * se.small,
est.small + qt(0.975, df = n.small - 1) * se.small)
ci.small
c(est.regular - qt(0.975, df = n.regular - 1) * se.regular,
est.regular + qt(0.975, df = n.regular - 1) * se.regular)
ci.regular

t.ci <- t.test(STAR$g4reading[STAR$classtype == 1],
STAR$g4reading[STAR$classtype == 2])
t.ci
```


ჰიპოთეზის შემოწმება
========================================================
* სტატისტიკური ჰიპოთეზის შემოწმება ეყრდნობა ფენომენის არსებობის დამტკიცებისადმი _ალბათურ მიდგომას_
	+ ან იმის მტკიცებას, რამდენად _შემთხვევითია_ ესა თუ ის მოვლენა
* მტკიცება საწინააღმდეგოს დამტკიცებით
	+ _Reductio ad absurdum_
* ნულოვანი ჰიპოთეზა $H_{0}$
	+ მკაცრი ნულოვანი ჰიპოთეზა: აფასებს ყველა პოტენციურ შედეგს
	+ არამკაცრი ნულოვანი ჰიპოთეზა: აფასებს _ექსპერიმენტის საშუალო შედეგს_

ჰიპოთეზის შემოწმება
========================================================
ნულოვანი ჰიპოთეზა ⇒ ტესტის სტატისტიკა ⇒ სახელმძღვანელო სტატისტიკა ⇒ იმის ალბათობის გამოთვლა, რომ სატესტო სტატისტიკა სახელმძღვანელო სტატისტიკაში გვხვდება

ჰიპოთეზის შემოწმება
========================================================
| Result |Rejecting $H_{0}$ | Retaining $H_{0}$ |
|--------|-----------|------------------|-------------------|
| $H_{0}$ True | Type I error | True        |
| $H_{0}$ False    | True       | Type II error |

ჰიპოთეზის შემოწმება
========================================================
* როგორ ვწყვეტთ, მივიღოთ თუ უარვყოთ ნულოვანი ჰიპოთეზა?
	+ რაოდენობრივი ფორმით უნდა ავსახოთ ის ხარისხი, რომლის ფარგლებშიც სატესტო სტატისტიკის არსებობის ალბათობა ნულოვანი ჰიპოთეზის ფარგლებში ძალიან დაბალია
	+ p-values



ჰიპოთეზის შემოწმება
========================================================
> Little p-value, What are you trying to say, Of significance?

_Stephen T. Ziliak, Roosvelt University_


ჰიპოთეზის შემოწმება
========================================================
* მნიშვნელოვნებ;
* ალბათობა იმისა, რომ ნულოვანი ჰიპოთეზის პირობებში, შეგვიძლია, გვქონდეს სატესტო სტატისტიკის რეალურად არსებულის მსგავსი ექსტრემალური მნიშვნელობა

* [მაგალითად:](http://blog.minitab.com/blog/adventures-in-statistics-2/how-to-correctly-interpret-p-values): 
ვთქვათ, ვამოწმებთ ახალ ვაქცინას, რისთვისაც ჩავატარეთ ექსპერიმენტი. ექსპერიმენტულ ჯგუფში, ტემპერატურა დაეცა, თუმცა გამოთვლილი p-მნიშვნელობა არის 0.04. ეს იმას ნიშნავს, რომ თუ _ვაქცინა არაეფექტური_ იქნებოდა, ექსპერიმენტულ და საკონტროლო ჯგუფებს შორის იგივე სხვაობას ყველა შემდგომი ექსპერიმენტის 4%-ში მივიღებდით.
* $p$-მნიშვნელობა არაა შეცდომის დაშვების ალბათობა!!!


ჰიპოთეზის შემოწმება
========================================================
* სანდოობის ინტერვალის მსგავსად, აქაც ვირჩევთ კონკრეტულ დონეს
	+ 95% ან 99%
<img src="img/neyman.PNG" alt="Drawing" style="width: 600px; display: block; margin-left: auto; margin-right: auto; margin-top: 30px;"/>

Neyman, J. (1937). Outline of a theory of statistical estimation based on the classical theory of probability. _Philosophical Transactions of the Royal Society of London._ Series A, Mathematical and Physical Sciences, 236(767), 333-380.


ჰიპოთეზის შემოწმება
========================================================
* P-მნიშვნელობა ერთი და ორი შერჩევის კრიტერიუმისთვის

ჰიპოთეზის შემოწმება
========================================================
* ერთი შერჩევის კრიტერიუმი:
	+ პოპულაციის საშუალო უდრის რომელიმე კონკრეტულ რიცხვს;
* ორი შერჩევის კრიტერიუმი:
	+ ორი პოპულაციის საშუალო ერთმანეთის ტოლია;

ჰიპოთეზის შემოწმება და სანდოობის ინტერვალები
========================================================
* z-scores for confidence intervals:
	+ $\frac{\overline{X}_{n}-\mathbb{E}_{X}}{Standard\ Error}$
* z-scores for $p$-values:
	+ $\frac{\overline{X}_{n}-\mu_{0}}{Standard\ Error}$


STAR-project
========================================================
One sample t-test

```r
t.test(STAR$g4reading, mu = 710)
```

STAR-project
========================================================
Two samples t-test

```r
t.test(STAR$g4reading[STAR$classtype == 1],
STAR$g4reading[STAR$classtype == 2])
```

შრომითი დისკრიმინაციის კვლევა
========================================================


```r
resume <- read.csv("resume.csv")
x <- table(resume$race, resume$call)
prop.test(x, alternative = "greater")
```

ჰიპოთეზის შემოწმება: რა _არ უნდა_ გავაკეთოთ
========================================================
* ,,პუბლიკაციების ცდომილება''
* ,,მრავლობითი ტესტირება''

