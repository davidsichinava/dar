setwd("D:\\Dropbox\\My projects\\Courses\\ST_R\\website\\meetings\\m7\\lab\\data")
idahot <- read_dta("May17_Only_responses_10072013.dta")
library(tidyr)
library(haven)
setwd("D:\\Dropbox\\My projects\\Courses\\ST_R\\website\\meetings\\m7\\lab\\data")
idahot <- read_dta("May17_Only_responses_10072013.dta")
idahot[] <- lapply(idahot, unclass)
recodeVal <- function(x) {
x <- dplyr::recode(x, `-1`=1, `-2`=1)
x <-na_if(x, -9)
x <-na_if(x, -3)
}
idahot$d16_1 <- recodeVal(idahot$d16_1)
recodeVal <- function(x) {
x <- dplyr::recode(x, `-1`=1, `-2`=1)
x <-dplyr::na_if(x, -9)
x <-dplyr::na_if(x, -3)
}
idahot$d16_1 <- recodeVal(idahot$d16_1)
idahot$d16_2 <- recodeVal(idahot$d16_2)
idahot$d16_3 <- recodeVal(idahot$d16_3)
idahot$d16_4 <- recodeVal(idahot$d16_4)
idahot$d16_5 <- recodeVal(idahot$d16_5)
idahot$d16_6 <- recodeVal(idahot$d16_6)
idahot$d16_index <- idahot$d16_1+idahot$d16_2+idahot$d16_3+
idahot$d16_4+idahot$d16_5+idahot$d16_6
summary(idahot$d16_index)
cor(idahot$d16_index, idahot$d2,method="spearman",use="complete.obs")
t.test(idahot$d16_index, idahot$d1)
mean(idahot$d16_index[idahot$d1 == 1])
mean(idahot$d16_index[idahot$d1 == 2])
mean(idahot$d16_index[idahot$d1 == 2], na.rm=TRUE)
mean(idahot$d16_index[idahot$d1 == 1])
mean(idahot$d16_index[idahot$d1 == 2], na.rm=TRUE)
mean(idahot$d16_index[idahot$d1 == 1])
mean(idahot$d16_index[idahot$d1 == 2], na.rm=TRUE)
mean(idahot$d16_index[idahot$d1 == 1])
mean(idahot$d16_index[idahot$d1 == 2], na.rm=TRUE)
cor(idahot$d16_index, idahot$d2,method="pearson",use="complete.obs")
t.test(idahot$d16_index, idahot$d1)
View(idahot)
table(idahot$gender)
idahot$q7
table(idahot$q7)
idahot$homophobia <- 0
idahot$homophobia[idahot$q7 == 5] <- 1
table(idahot$homophobia)
t.test(idahot$d16_index, idahot$homophobia)
recodeAcc <- function(x) {
x <- dplyr::recode(x, `-1`=3, `-2`=3, `3`=4, `4`=5)
x <-dplyr::na_if(x, -9)
x <-dplyr::na_if(x, -3)
}
idahot$q8_2 <- recodeVal(idahot$q8_2)
idahot$q8_3 <- recodeVal(idahot$q8_3)
idahot$q8_4 <- recodeVal(idahot$q8_4)
idahot$minorities <- idahot$q8_2+idahot$q8_3+idahot$q8_4
summary(idahot$minorities)
cor(idahot$d16_index, idahot$minorities,method="spearman",use="complete.obs")
t.test(idahot$minorities, idahot$d1)
mean(idahot$minorities[idahot$d1 == 1])
mean(idahot$minorities[idahot$d1 == 2], na.rm=TRUE)
t.test(idahot$d16_index, idahot$homophobia)
t.test(idahot$minorities, idahot$homophobia)
table(idahot$d4)
idahot$education <- 0
idahot$education[idahot$4 >  3] <- 1
idahot$education[idahot$d4 >  3] <- 1
table(idahot$education)
t.test(idahot$d16_index, idahot$education)
t.test(idahot$minorities, idahot$education)
prop.table(idahot$homophobia, idahot$education)
chisq.test(idahot$homophobia, idahot$education)
ggplot(idahot, aes(d16_index, minorities))+
geom_point(aes(color=homophobia))+
theme_minimal()
library(tidyverse)
ggplot(idahot, aes(d16_index, minorities))+
geom_point(aes(color=homophobia))+
theme_minimal()
ggplot(idahot, aes(d16_index, minorities))+
geom_point(aes(color=homophobia))+
theme_minimal()
ggplot(idahot, aes(d16_index, minorities))+
geom_bar(aes(fill=homophobia))+
theme_minimal()
ggplot(idahot, aes(d16_index, minorities))+
geom_bar(aes(fill=homophobia), stat="identity")+
theme_minimal()
ggplot(idahot, aes(d16_index, minorities))+
geom_bar(aes(fill=factor(homophobia), stat="identity"))+
theme_minimal()
ggplot(idahot, aes(d16_index, minorities, group=factor(homophobia)))+
geom_bar(stat="identity")+
theme_minimal()
ggplot(idahot, aes(d16_index, group=factor(homophobia)))+
geom_bar(stat="identity")+
theme_minimal()
ggplot(idahot, aes(d16_index, group=factor(homophobia)))+
geom_col(stat="identity")+
theme_minimal()
ggplot(idahot, aes(d16_index, homophobia))+
geom_col(stat="identity")+
theme_minimal()
ggplot(idahot, aes(d16_index))+
geom_bar(stat="identity")+
theme_minimal()
ggplot(idahot, aes(d16_index))+
geom_bar()+
theme_minimal()
ggplot(idahot, aes(d16_index, group=d1))+
geom_bar(aes(weight=WTIND))+
theme_minimal()
ggplot(idahot, aes(d16_index, group=d1))+
geom_bar(aes(weight=INDWT))+
theme_minimal()
View(idahot)
ggplot(idahot, aes(d16_index, group=d1))+
geom_bar(aes(weight=indwt))+
theme_minimal()
ggplot(idahot, aes(d16_index))+
geom_bar(aes(weight=indwt))+
theme_minimal()+
facet_wrap(~d1)
ggplot(idahot, aes(d16_index))+
geom_bar(aes(weight=indwt), position = "fill")+
theme_minimal()+
facet_wrap(~d1)
ggplot(idahot, aes(d16_index))+
geom_bar(aes(weight=indwt))+
theme_minimal()+
facet_wrap(~d1)
lower <- cbind(idahot$d16_index[idahot$education == 0],
idahot$minorities[idahot$education == 0])
higher <- cbind(idahot$d16_index[idahot$education == 1],
idahot$minorities[idahot$education == 1])
warnings()
lower <- cbind(idahot$d16_index[idahot$education == 0],
idahot$minorities[idahot$education == 0])
higher <- cbind(idahot$d16_index[idahot$education == 1],
idahot$minorities[idahot$education == 1])
lower.out <- kmeans(lower, centers = 2, nstart = 5)
lower.out <- kmeans(lower, centers = 2, nstart = 5)
lower.out <- kmeans(lower, centers = 2, nstart = 5, na.rm=TRUE)
table(lower)
table(higher)
View(lower)
lower.out <- kmeans(lower, centers = 2, nstart = 2)
is.na(lower)
is.na(higher)
table(is.na(higher))
table(is.na(lower))
higher.out <- kmeans(higher, centers = 2, nstart = 5)
lower[is.na(lower)] <- mean(lower, na.rm=TRUE)
lower.out <- kmeans(lower, centers = 2, nstart = 2)
higher.out <- kmeans(higher, centers = 2, nstart = 5)
lower.out$centers
higher.out$centers
table(education = lower$homophobia[lower$education == 1],
cluster = lower.out$cluster)
table(education = idahot$homophobia[idahot$education == 1],
cluster = lower.out$cluster)
table(education = idahot$education[idahot$homophobia == 1],
cluster = lower.out$cluster)
table(lower.out$cluster)
table(idahot$education)
table(education = idahot$education[idahot$homophobia == 0],
cluster = lower.out$cluster)
table(education = idahot$d1[idahot$education == 0],
cluster = lower.out$cluster)
table(education = idahot$d1[idahot$education == 1],
cluster = higher$cluster)
table(education = idahot$d1[idahot$education == 1],
cluster = higher$cluster)
table(education = idahot$d1[idahot$education == 1],
cluster = higher.out$cluster)
table(education = idahot$d1[idahot$education == 0],
cluster = lower.out$cluster)
table(education = idahot$d1[idahot$education == 1],
cluster = higher.out$cluster)
table(gender = idahot$d1[idahot$education == 0],
cluster = lower.out$cluster)
table(gender = idahot$d1[idahot$education == 1],
cluster = higher.out$cluster)
gender
table(gender = idahot$d1[idahot$education == 0],
cluster = lower.out$cluster)
table(gender = idahot$d1[idahot$education == 1],
cluster = higher.out$cluster)
lower.out$centers
higher.out$centers
plot(lower)
plot(lower, lower.out$centers)
plot(lower, lower.out$cluster)
plot(lower, lower.out$cluster+1)
table(gender = idahot$d1[idahot$education == 0],
cluster = lower.out$cluster)
table(gender = idahot$d1[idahot$education == 1],
cluster = higher.out$cluster)
prop.table(table(gender = idahot$d1[idahot$education == 0],
cluster = lower.out$cluster))
prop.table(table(gender = idahot$d1[idahot$education == 1],
cluster = higher.out$cluster))
ggplot(idahot, aes(homophobia, group=d1))+
geom_bar(aes(weight=indwt))+
theme_minimal()+
facet_wrap(~d1)
ggplot(idahot, aes(homophobia, group=d1, fill=homophobia))+
geom_bar(aes(weight=indwt, position="fill"))+
theme_minimal()+
facet_wrap(~d1)
ggplot(idahot, aes(homophobia, group=d1, fill=homophobia))+
geom_bar(aes(weight=indwt), position="fill")+
theme_minimal()+
facet_wrap(~d1)
ggplot(idahot, aes(homophobia, fill=d1))+
geom_bar(aes(weight=indwt), position="fill")+
theme_minimal()+
facet_wrap(~d1)
ggplot(idahot, aes(homophobia, fill=homophobia))+
geom_bar(aes(weight=indwt), position="fill")+
theme_minimal()+
facet_wrap(~d1)
ggplot(idahot, aes(homophobia, fill=homophobia))+
geom_bar(aes(weight=indwt))+
theme_minimal()+
facet_wrap(~d1)
ggplot(idahot, aes(homophobia, fill=homophobia))+
geom_bar(aes(weight=indwt), stat="count")+
theme_minimal()+
facet_wrap(~d1)
ggplot(idahot, aes(homophobia, ..prop.., fill=homophobia))+
geom_bar(aes(weight=indwt), stat="count")+
theme_minimal()+
facet_wrap(~d1)
ggplot(idahot, aes(factor(homophobia), ..prop.., fill=homophobia))+
geom_bar(aes(weight=indwt), stat="count")+
theme_minimal()+
facet_wrap(~d1)
ggplot(idahot, aes(factor(homophobia), fill=homophobia))+
geom_bar(aes(weight=indwt), stat="count")+
theme_minimal()+
facet_wrap(~d1)
ggplot(idahot, aes(factor(homophobia), ..prop.., fill=homophobia))+
geom_bar(aes(weight=indwt))+
theme_minimal()+
facet_wrap(~d1)
ggplot(idahot, aes(factor(homophobia), ..prop.., fill=homophobia))+
geom_bar(aes(weight=indwt), stat="identity")+
theme_minimal()+
facet_wrap(~d1)
ggplot(idahot, aes(factor(homophobia),  fill=homophobia))+
geom_bar(aes(weight=indwt), stat="identity")+
theme_minimal()+
facet_wrap(~d1)
ggplot(idahot, aes(factor(homophobia), ..prop.., fill=homophobia))+
geom_bar(aes(weight=indwt))+
theme_minimal()+
facet_wrap(~d1)
ggplot(idahot, aes(homophobia, ..prop.., fill=homophobia))+
geom_bar(aes(weight=indwt))+
theme_minimal()+
facet_wrap(~d1)
idahot$homophobia <- factor(idahot$homophobia, levels =c(0, 1), labels= c("Yes", "No"))
ggplot(idahot, aes(homophobia, ..prop.., fill=homophobia))+
geom_bar(aes(weight=indwt))+
theme_minimal()+
facet_wrap(~d1)
ggplot(idahot, aes(homophobia, fill=homophobia))+
geom_bar(aes(weight=indwt))+
theme_minimal()+
facet_wrap(~d1)
ggplot(idahot, aes(homophobia))+
geom_bar(aes(weight=indwt))+
theme_minimal()+
facet_wrap(~d1)
ggplot(idahot, aes(homophobia))+
geom_bar(aes(weight=indwt), stat="identity")+
theme_minimal()+
facet_wrap(~d1)
ggplot(idahot, aes(homophobia))+
geom_bar(aes(weight=indwt), stat="count")+
theme_minimal()+
facet_wrap(~d1)
ggplot(idahot, aes(homophobia,y = ..prop.., group = 1))+
geom_bar(aes(weight=indwt), stat="count")+
theme_minimal()+
facet_wrap(~d1)
ggplot(idahot, aes(homophobia, y = ..prop.., group = 1))+
geom_bar(aes(weight=indwt), stat="count")+
theme_minimal()+
facet_wrap(~d1)
ggplot(idahot, aes(homophobia, y = ..prop.., group = 1, fill=homophobia))+
geom_bar(aes(weight=indwt), stat="count")+
theme_minimal()+
facet_wrap(~d1)
ggplot(idahot, aes(homophobia, y = ..prop.., group = 1))+
geom_bar(aes(weight=indwt), stat="count", fill=homophobia)+
theme_minimal()+
facet_wrap(~d1)
ggplot(idahot, aes(homophobia, y = ..prop.., group = 1), fill=homophobia)+
geom_bar(aes(weight=indwt), stat="count")+
theme_minimal()+
facet_wrap(~d1)
ggplot(idahot, aes(homophobia, y = ..prop.., group = 1, fill=homophobia))+
geom_bar(aes(weight=indwt), stat="count")+
theme_minimal()+
facet_wrap(~d1)
ggplot(idahot, aes(homophobia, y = ..prop.., group = 1))+
geom_bar(aes(weight=indwt, fill=homophobia), stat="count")+
theme_minimal()+
facet_wrap(~d1)
ggplot(idahot, aes(homophobia, y = ..prop.., group = 1))+
geom_bar(aes(weight=indwt, color=homophobia), stat="count")+
theme_minimal()+
facet_wrap(~d1)
idahot$d1 <- factor(idahot$d1, levels =c(1, 2), labels= c("კაცი", "ქალი"))
ggplot(idahot, aes(homophobia, y = ..prop.., group = 1))+
geom_bar(aes(weight=indwt, color=homophobia), stat="count")+
theme_minimal()+
facet_wrap(~d1)
ggplot(idahot, aes(homophobia, y = ..prop.., group = 1))+
geom_bar(aes(weight=indwt, color=homophobia), stat="count")+
theme_minimal()+
facet_wrap(~d1)+
labs(title="ვის არ ისურვებდით მეზობლად?",
subtitle=",,ჰომოსექსუალებს''",
caption="გამოკითხვა 2013 წლის 17 მაისის მოვლენების შესახებ"))
ggplot(idahot, aes(homophobia, y = ..prop.., group = 1))+
geom_bar(aes(weight=indwt, color=homophobia), stat="count")+
theme_minimal()+
facet_wrap(~d1)+
labs(title="ვის არ ისურვებდით მეზობლად?",
subtitle="ჰომოსექსუალებს",
caption="გამოკითხვა 2013 წლის 17 მაისის მოვლენების შესახებ"))
ggplot(idahot, aes(homophobia, y = ..prop.., group = 1))+
geom_bar(aes(weight=indwt, color=homophobia), stat="count")+
theme_minimal()+
facet_wrap(~d1)+
labs(title="ვის არ ისურვებდით მეზობლად?",
subtitle="ჰომოსექსუალებს",
caption="გამოკითხვა 2013 წლის 17 მაისის მოვლენების შესახებ")
idahot$education <- factor(idahot$education, levels =c(0, 1), labels= c("უმაღლესზე დაბალი", "სრული ან არასრული უმაღლესი"))
ggplot(idahot, aes(homophobia, y = ..prop.., group = 1))+
geom_bar(aes(weight=indwt, color=homophobia), stat="count")+
theme_minimal()+
facet_wrap(~education)+
labs(title="ვის არ ისურვებდით მეზობლად?",
subtitle="ჰომოსექსუალებს",
caption="გამოკითხვა 2013 წლის 17 მაისის მოვლენების შესახებ")
unlink('lab5key_cache', recursive = TRUE)
